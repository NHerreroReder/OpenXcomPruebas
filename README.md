# OpenXcom [![Workflow Status][workflow-badge]][actions-url]

[workflow-badge]: https://github.com/OpenXcom/OpenXcom/workflows/ci/badge.svg
[actions-url]: https://github.com/OpenXcom/OpenXcom/actions

OpenXcom is an open-source clone of the popular "UFO: Enemy Unknown" ("X-COM:
UFO Defense" in the USA release) and "X-COM: Terror From the Deep" videogames
by Microprose, licensed under the GPL and written in C++ / SDL.

See more info at the [website](https://openxcom.org)
and the [wiki](https://www.ufopaedia.org/index.php/OpenXcom).

Uses modified code from SDL\_gfx (LGPL) with permission from author.

## Battlescape Editor

Battlescape Editor by ohartenstein23
 (https://github.com/ohartenstein23/OpenXcom/tree/battlescape-editor) is a fork from original OXCE which allows editing MAP files
 Main features are:
 - Editing of maps included in the currently loaded set of mods
 - Creating new maps from the terrains defined in the currently loaded set of mods
 - Editing single tiles at a time by adding, changing, or removing objects within the tile
 - Editing single AI nodes at a time by adding, moving, changing, and removing them and their links
 - Switching between tile and AI node editing modes
 - Undoing and redoing single tile/node edits
 - Saving edited .MAP and .RMP files in the current OXCE user folder
 - Sample ruleset for implementation of the edited .MAP and .RMP files in the openxcom.log file
 - Opening the main Map Editor Menu for creating/selecting a new map to edit directly from the Editor Interface.
 - Editing multiple tiles/nodes at a time by both rectangular selection and paintbrush-style selection tools
 - Copying, cutting, and pasting selections of multiple tiles/nodes at once
 - Find and replace tools for searching and editing tile and node content
 - Searching of text lists in the Map Editor Menu
 - Find and replace tools for searching and editing tile and node content

Documentation can be found [here](https://openxcom.org/forum/index.php?action=dlattach;topic=8711.0;attach=53017).

## Battlescape Editor MAP/MAP2 fork

This version is a fork of original Battlescape Editor with a new MAP2 format support.

It allows using old MAP and also new MAP2 versions of terrain blocks. MAP2 info is stored in uint16_t instead of char, so there is no virtual limit for tiles used in a map.

- In case of having MAP & MAP2 maps with the same name, it will load first MAP files (will try MAP at mod/MAPS directory, then /standard/xcom1/MAPS, then UFO/MAPS; if not found will try again with MAP2 extension).

- Maps at /user folder should have been generated by Battlescape Editor OR have a "terrain ruleset entry" at /user/modname/mapeditor.sav file. Also in order to be loaded, a RMP file with the samen name muts be placed at /user folder, causing a program crash otherwise.

- When saving a edited MAP file, format can be chosen using a MAP/MAP2 combo box. Save feature has a safeguard to avoid saving with MAP format if map is using indexes > 255.

- Includes a button in Editor's main menu to Batch-convert all MAPs loaded by the mod to MAP2 format. They will be stored in /user/mod/ folder so, in order to be used, same-name MAP files must be removed from all MAP folders (mod, standard/xcom1, UFO)
  and new MAP2 files should be placed in mod's MAP folder instead.

- Terrain definitions can include now more MCD files, in order to have more than 255 different tiles. Just add more MCD files names at terrain ruleset definition.

- MAP/MAP2 files can be mixed in a terrain ruleset, but if a MAP file uses a tile with index > 255 it will be displayed incorrectly. So it's better to load first MCD files with info for MAP files and then
the extra tiles for MAP2 blocks.

### Fixed some bugs at original version:
- When opening Editor and FileBrowser, later in-game  battlescape could crash, due to not deleting editor Object. 
- FileBrowser only shows now MAP/MAP2 files to avoid trying to load inadequate files.
- If MapEditor windows was closed without saving a MAP, it crashed trying to generate a mapeditor.sav file, which 
  should be then deleted in order to start Editor again.   

For convenience, windows packages have been added to folder 'WindowsBinaries'. Packages include files needed for OXCE basic install (common, standard and user folders) but resources from original games must be placed in UFO and TFTD folders. An example folder has been provided with instructions and files to test MAP2 files use. 

[Link to Windows Binary folder](WindowsBinaries/)

## Installation

OpenXcom requires a vanilla copy of the X-COM resources -- from either or both
of the original games.  If you own the games on Steam, the Windows installer
will automatically detect it and copy the resources over for you.

If you want to copy things over manually, you can find the Steam game folders
at:

    UFO: "Steam\SteamApps\common\XCom UFO Defense\XCOM"
    TFTD: "Steam\SteamApps\common\X-COM Terror from the Deep\TFD"

Do not use modded versions (e.g. with XcomUtil) as they may cause bugs and
crashes.  Copy the UFO subfolders to the UFO subdirectory in OpenXcom's data
or user folder and/or the TFTD subfolders to the TFTD subdirectory in OpenXcom's
data or user folder (see below for folder locations).

## Mods

Mods are an important and exciting part of the game.  OpenXcom comes with a set
of standard mods based on traditional XcomUtil and UFOExtender functionality.
There is also a [mod portal website](https://openxcom.mod.io/) with a thriving
mod community with hundreds of innovative mods to choose from.

To install a mod, go to the mods subdirectory in your user directory (see below
for folder locations).  Extract the mod into a new subdirectory.  WinZip has an
"Extract to" option that creates a directory whose name is based on the archive
name.  It doesn't really matter what the directory name is as long as it is
unique.  Some mods are packed with extra directories at the top, so you may
need to move files around inside the new mod directory to get things straighted
out.  For example, if you extract a mod to mods/LulzMod and you see something
like:

    mods/LulzMod/data/TERRAIN/
    mods/LulzMod/data/Rulesets/

and so on, just move everything up a level so it looks like:

    mods/LulzMod/TERRAIN/
    mods/LulzMod/Rulesets/

and you're good to go!  Enable your new mod on the Options -> Mods page in-game.

## Directory Locations

OpenXcom has three directory locations that it searches for user and game files:

<table>
  <tr>
    <th>Folder Type</th>
    <th>Folder Contents</th>
  </tr>
  <tr>
    <td>user</td>
    <td>mods, savegames, screenshots</td>
  </tr>
  <tr>
    <td>config</td>
    <td>game configuration</td>
  </tr>
  <tr>
    <td>data</td>
    <td>UFO and TFTD data files, standard mods, common resources</td>
  </tr>
</table>

Each of these default to different paths on different operating systems (shown
below).  For the user and config directories, OpenXcom will search a list of
directories and use the first one that already exists.  If none exist, it will
create a directory and use that.  When searching for files in the data
directory, OpenXcom will search through all of the named directories, so some
files can be installed in one directory and others in another.  This gives
you some flexibility in case you can't copy UFO or TFTD resource files to some
system locations.  You can also specify your own path for each of these by
passing a commandline argument when running OpenXcom.  For example:

    openxcom -data "$HOME/bin/OpenXcom/usr/share/openxcom"

or, if you have a fully self-contained installation:

    openxcom -data "$HOME/games/openxcom/data" -user "$HOME/games/openxcom/user" -config "$HOME/games/openxcom/config"

### Windows

User and Config folder:
- C:\Documents and Settings\\\<user\>\My Documents\OpenXcom (Windows 2000/XP)
- C:\Users\\\<user\>\Documents\OpenXcom (Windows Vista/7)
- \<game directory\>\user
- .\user

Data folders:
- C:\Documents and Settings\\\<user\>\My Documents\OpenXcom\data (Windows 2000/XP)
- DATADIR build flag
- C:\Users\\\<user\>\Documents\OpenXcom\data (Windows Vista/7/8)
- \<game directory\>
- . (the current directory)

### Mac OS X

User and Config folder:
- $XDG\_DATA\_HOME/openxcom (if $XDG\_DATA\_HOME is defined)
- $HOME/Library/Application Support/OpenXcom
- $HOME/.openxcom
- ./user

Data folders:
- $XDG\_DATA\_HOME/openxcom (if $XDG\_DATA\_HOME is defined)
- $HOME/Library/Application Support/OpenXcom (if $XDG\_DATA\_HOME is not defined)
- DATADIR build flag
- $XDG\_DATA\_DIRS/openxcom (for each directory in $XDG\_DATA\_DIRS if $XDG\_DATA\_DIRS is defined)
- /Users/Shared/OpenXcom (if $XDG\_DATA\_DIRS is not defined or is empty)
- . (the current directory)

### Linux

User folder:
- $XDG\_DATA\_HOME/openxcom (if $XDG\_DATA\_HOME is defined)
- $HOME/.local/share/openxcom (if $XDG\_DATA\_HOME is not defined)
- $HOME/.openxcom
- ./user

Config folder:
- $XDG\_CONFIG\_HOME/openxcom (if $XDG\_CONFIG\_HOME is defined)
- $HOME/.config/openxcom (if $XDG\_CONFIG\_HOME is not defined)

Data folders:
- $XDG\_DATA\_HOME/openxcom (if $XDG\_DATA\_HOME is defined)
- $HOME/.local/share/openxcom (if $XDG\_DATA\_HOME is not defined)
- DATADIR build flag
- $XDG\_DATA\_DIRS/openxcom (for each directory in $XDG\_DATA\_DIRS if $XDG\_DATA\_DIRS is defined)
- /usr/local/share/openxcom (if $XDG\_DATA\_DIRS is not defined or is empty)
- /usr/share/openxcom (if $XDG\_DATA\_DIRS is not defined or is empty)
- the directory data files were installed to
- . (the current directory)

## Configuration

OpenXcom has a variety of game settings and extras that can be customized, both
in-game and out-game. These options are global and affect any old or new
savegame.

For more details please check the [wiki](https://ufopaedia.org/index.php/Options_(OpenXcom)).

## Development

OpenXcom requires the following developer libraries:

- [SDL](https://www.libsdl.org) (libsdl1.2)
- [SDL\_mixer](https://www.libsdl.org/projects/SDL_mixer/) (libsdl-mixer1.2)
- [SDL\_gfx](https://www.ferzkopp.net/wordpress/2016/01/02/sdl_gfx-sdl2_gfx/) (libsdl-gfx1.2), version 2.0.22 or later
- [SDL\_image](https://www.libsdl.org/projects/SDL_image/) (libsdl-image1.2)

The source code includes files for the following build tools:

- Microsoft Visual C++ 2010 or newer
- Xcode
- Make (see Makefile.simple)
- CMake

It's also been tested on a variety of other tools on Windows/Mac/Linux. More
detailed compiling instructions are available at the
[wiki](https://ufopaedia.org/index.php/Compiling_(OpenXcom)), along with
pre-compiled dependency packages.
